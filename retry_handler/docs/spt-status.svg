<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="612px" preserveAspectRatio="none" style="width:429px;height:612px;" version="1.1" viewBox="0 0 429 612" width="429px" zoomAndPan="magnify"><defs><filter height="300%" id="fmoo0hqk8dgvw" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="237" x="102.5" y="16.708">SPT states in retry handler</text><ellipse cx="100" cy="53.9531" fill="#000000" filter="url(#fmoo0hqk8dgvw)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fmoo0hqk8dgvw)" height="50.2656" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="145.5" y="28.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="145.5" x2="284.5" y1="55.25" y2="55.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="185" y="46.9482">alloc_spt</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="119" x="150.5" y="71.3887">an SPT is allocated</text><rect fill="#FEFECE" filter="url(#fmoo0hqk8dgvw)" height="50.2656" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="232" x="6" y="170.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="6" x2="238" y1="197.25" y2="197.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="97" x="73.5" y="188.9482">STS_PENDING</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="212" x="11" y="213.3887">Cassini is still working on that SPT</text><rect fill="#FEFECE" filter="url(#fmoo0hqk8dgvw)" height="50.2656" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="147" x="153.5" y="297.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="153.5" x2="300.5" y1="324.25" y2="324.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="127" x="163.5" y="315.9482">STS_NEED_RETRY</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="92" x="158.5" y="340.3887">awaits retrying</text><rect fill="#FEFECE" filter="url(#fmoo0hqk8dgvw)" height="50.2656" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="117" x="168.5" y="424.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="168.5" x2="285.5" y1="451.25" y2="451.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="95" x="179.5" y="442.9482">STS_RETRIED</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="97" x="173.5" y="467.3887">SPT was retried</text><rect fill="#FEFECE" filter="url(#fmoo0hqk8dgvw)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="141" x="156.5" y="551.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="156.5" x2="297.5" y1="578.25" y2="578.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="166.5" y="569.9482">STS_COMPLETED</text><ellipse cx="343" cy="576.9531" fill="none" filter="url(#fmoo0hqk8dgvw)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="343.5" cy="577.4531" fill="#000000" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><!--link *start to alloc_spt--><path d="M110.332,53.9531 C120.3129,53.9531 130.2937,53.9531 140.2746,53.9531 " fill="none" id="*start-alloc_spt" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="145.4939,53.9531,136.4939,49.9531,140.4939,53.9531,136.4939,57.9531,145.4939,53.9531" style="stroke: #A80036; stroke-width: 1.0;"/><!--link alloc_spt to STS_PENDING--><path d="M145.3865,70.1126 C125.3833,78.3261 105.8055,90.6191 94,108.9531 C82.7548,126.4169 90.3316,148.7693 100.4215,166.4442 " fill="none" id="alloc_spt-STS_PENDING" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="103.0309,170.8312,101.8679,161.0513,100.4749,166.5339,94.9922,165.1409,103.0309,170.8312" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="207" x="95" y="122.02">rsp_status == C_RSP_PEND &amp;&amp;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="151" y="137.1528">to_flag == false</text><!--link alloc_spt to STS_NEED_RETRY--><path d="M280.7655,79.1758 C292.8441,86.8714 303.8725,96.6552 311,108.9531 C330.4833,142.5697 335.7151,184.1115 289,267.9531 C283.5833,277.6747 275.7803,286.5424 267.5274,294.1848 " fill="none" id="alloc_spt-STS_NEED_RETRY" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="263.4483,297.8364,272.8218,294.8137,267.1736,294.5014,267.4858,288.8532,263.4483,297.8364" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="325" y="200.52">other cases</text><!--link STS_PENDING to STS_NEED_RETRY--><path d="M142.7446,221.0442 C160.074,242.0045 184.7973,271.908 202.9823,293.9031 " fill="none" id="STS_PENDING-STS_NEED_RETRY" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="206.2985,297.9141,203.6466,288.429,203.1125,294.0606,197.481,293.5265,206.2985,297.9141" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="182" y="264.02">status is known</text><!--link STS_NEED_RETRY to STS_RETRIED--><path d="M175.4821,347.9838 C157.4924,360.4212 143.8219,376.6959 153,394.9531 C158.2215,405.3397 166.4359,414.2595 175.525,421.7089 " fill="none" id="STS_NEED_RETRY-STS_RETRIED" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="179.4677,424.8115,174.8684,416.1025,175.5383,421.7196,169.9213,422.3895,179.4677,424.8115" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="154" y="391.02">retry successful</text><!--link STS_RETRIED to STS_NEED_RETRY--><path d="M245.3,424.907 C250.8302,415.9156 256.1805,405.4057 259,394.9531 C262.8708,380.6029 257.6911,365.4636 250.4462,352.7902 " fill="none" id="STS_RETRIED-STS_NEED_RETRY" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="247.6966,348.2387,248.9267,358.0105,250.2821,352.5184,255.7742,353.8737,247.6966,348.2387" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="262" y="391.02">timeout or NACK event</text><!--link STS_NEED_RETRY to STS_NEED_RETRY--><path d="M300.5314,311.414 C320.3912,312.0227 335.5,315.8691 335.5,322.9531 C335.5,329.4283 322.8764,333.1985 305.5396,334.2636 " fill="none" id="STS_NEED_RETRY-STS_NEED_RETRY" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="300.5314,334.4922,309.7045,338.0774,305.5262,334.2641,309.3395,330.0857,300.5314,334.4922" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="341.5" y="327.52">PCP paused</text><!--link STS_RETRIED to STS_COMPLETED--><path d="M227,475.0442 C227,495.6566 227,524.9178 227,546.8015 " fill="none" id="STS_RETRIED-STS_COMPLETED" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="227,551.9141,231,542.9141,227,546.9141,223,542.9141,227,551.9141" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="228" y="518.02">complete event / cancelled</text><!--link STS_COMPLETED to *end--><path d="M297.6875,576.9531 C307.6356,576.9531 317.5836,576.9531 327.5317,576.9531 " fill="none" id="STS_COMPLETED-*end" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="332.7339,576.9531,323.7339,572.9531,327.7339,576.9531,323.7339,580.9531,332.7339,576.9531" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml

title SPT states in retry handler

[*] -> alloc_spt

alloc_spt : an SPT is allocated
alloc_spt - -> STS_PENDING : rsp_status == C_RSP_PEND && \n to_flag == false
alloc_spt - -> STS_NEED_RETRY : other cases

STS_PENDING : Cassini is still working on that SPT
STS_PENDING - -> STS_NEED_RETRY : status is known

STS_NEED_RETRY : awaits retrying
STS_NEED_RETRY - -> STS_RETRIED : retry successful
STS_NEED_RETRY - -> STS_NEED_RETRY : PCP paused

STS_RETRIED : SPT was retried
STS_RETRIED - -> STS_NEED_RETRY : timeout or NACK event
STS_RETRIED - -> STS_COMPLETED : complete event / cancelled

STS_COMPLETED -> [*]

@enduml

PlantUML version 1.2018.13(Mon Nov 26 11:11:51 CST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.5-ea+10-post-Ubuntu-0ubuntu1
Operating System: Linux
OS Version: 5.3.0-24-generic
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>